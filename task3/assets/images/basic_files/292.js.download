(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[292,152,291,582,588],{1998:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return k}),n.d(t,"resourceKey",function(){return P});var a=n(0),i=(n(1916),n(2218)),r=n(2322),o=n(2276),s=n(2252),c=n(108),d=n(353),l=n(116),u=n(945),f=n(595),p=n(2341),m=n(1192),_=n(2450),h=n(2619);function b(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}var g=n(1792),v=n(6),y=n(62),S=n(2274),D=n(260),I=n(2581),x=n("knockout-lib"),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(2239),E=n(2),A=n(5),L=100,k=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.qo)(E.Ao))}),M=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this.invalidateItem(e.parentKey),[4,this.resources.consumeAsync(l.k)];case 1:return t.sent().invalidateItems(e.parentKey),[2,n]}})})})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?L:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=A.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var k=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);k.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&k.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=k.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=k.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b(d,{start:0,end:t.totalChildren})){var E=g.e(e),A=E.startIndex,M=void 0===A?0:A;return E.startIndex=M+L,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||L;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=L);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=L},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.ee.optional,itemsStore:s.t,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:k.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),P=(t.default=M,Object(y.r)("ItemProvider",M))},2218:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return _});var a=n(0),i=n(6),r=n(62),o=n(186),s=n(199),c=n(1323),d=n(288),l="@ms/odsp-shared/lib/base/BaseModel",u=new i.t({name:"".concat(l,".asyncType"),factory:new i.e(s.e)}),f=new i.t({name:"".concat(l,".observablesFactoryType"),factory:new r.a(c.e,{asyncType:u.optional})}),p=new i.t({name:"".concat(l,".eventGroupType"),factory:new i.e(o.t)}),m=new i.t({name:"".concat(l,".errorHandler")}),_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.id,r=void 0===i?"":i;return a.id=r,a._BaseModel_dependencies=n,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})},t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)},t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)},t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)},t.prototype.addDisposable=function(e){return this.scope.attach(e)},t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.wrapObservable=function(e){return this.observables.wrap(e)},t.prototype.peekUnwrapObservable=function(e){return Object(c.a)(e)},t.prototype.createObservable=function(e){return this.observables.create(e)},t.prototype.unwrapObservable=function(e){return Object(c.i)(e)},t.prototype.isObservable=function(e){return Object(c.n)(e)},t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getAsync=function(){return e},e},t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getEvents=function(){return e},e},t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});return this._BaseModel_getObservables=function(){return e},e},t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(u.optional)||s.e},t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t},t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(f.optional)||Object(i.i)(c.e,{asyncType:this._BaseModel_getAsyncType()}))||c.e},t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(m.optional)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},d.e.dependencies),{asyncType:u.optional,observablesFactoryType:f.optional,eventGroupType:p.optional,errorHandler:m.optional}),t}(d.e);t.n=_},2219:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(2218),r=n("knockout-lib"),o=n(2263),s=n(6),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.element=t.element,a.valueAccessor=t.valueAccessor,a.allBindingsAccessor=t.allBindingsAccessor,a.bindingContext=t.bindingContext,a.controlsDescendantBindings=!1,a}return Object(a.__extends)(t,e),t.init=function(e,t,n,a,i){var c=new s.n(o.e(i)),d=new(this.supportsDependencies?c.resolved(this):c.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});return r.utils.domNodeDisposal.addDisposeCallback(e,function(){return d.dispose()}),{controlsDescendantBindings:d.controlsDescendantBindings}},t.dependencies=Object(a.__assign)({},i.n.dependencies),t.supportsVirtualElements=!1,t.supportsDependencies=!1,t}(i.n);t.t=c},2220:function(e,t,n){"use strict";var a=n(0),i=n(2218),r=n(35),o=n(2390),s=n("knockout-lib"),c="__automationTypeBinding$elements",d={init:function(e,t,n,a,i){if(s.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i),i){var r=i.$component;if(r){var o=s.utils.unwrapObservable(t());if(o){var d=r[c];d||(d=r[c]={});var l=d[o];l||(l=d[o]=[]),l.push(e),s.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=l.indexOf(e);-1!==t&&(delete l[t],l.splice(t,1))})}}}}},l=n(2219),u=n(16),f=function(e){function t(t){var n=e.call(this,t)||this,a=n.element.getAttribute("class");return n.element.setAttribute("class",n._expandIconClassNames(a)),n}return Object(a.__extends)(t,e),t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),a=[],i=0,r=n;i<r.length;i++){var o=r[i];if(this._lastClassesAdded&&this._lastClassesAdded[o]||a.push(o),0===o.indexOf("ms-Icon--")){var s=o.substring(9),c=Object(u.E)(s);c&&-1===n.indexOf(c)&&(t[c]=!0,a.push(c))}}return this._lastClassesAdded=t,a.join(" ")}return e},t.after=["css","class"],t}(l.e),p=n(184),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.bindingHandlers={},a.automationId=t&&t.automationId||void 0,a.addBindingHandlers({automation:o.e,automationType:d,icon:f}),a}return Object(a.__extends)(t,e),t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)},t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.format)(e,t)},t.prototype.addBindingHandlers=function(e){Object(p.e)(this.bindingHandlers,e)},t}(i.n);t.e=m},2221:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("knockout-lib"),i=n(1321);function r(e){var t=e.tagName,n=e.template,i=e.viewModel,r=e.synchronous,o=void 0!==r&&r;return a.components.register(t,{viewModel:i,template:n,synchronous:o}),e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html"),n.id=e,i.e.setText(n,t),document.head.appendChild(n)}},2222:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"t",function(){return m}),n.d(t,"e",function(){return _});var a=n(0),i=(n(2271),n(2219)),r=n(6),o=n(2232),s=n(108),c=n(2284),d=n(373),l=n(102),u=n("knockout-lib");function f(e,t){return{definitionKey:e,params:t}}var p=function(){function e(e){var t=e.viewModelType;this.dependencies=Object(a.__assign)(Object(a.__assign)({},t.dependencies||{}),e.dependencies||{}),this._automationName=e.automationName,this._viewModelType=e.viewModelType,this._template=e.template}return e.prototype.create=function(e){var t=this,n=e.resources,i=function(t){function i(i){return t.call(this,i,Object(a.__assign)(Object(a.__assign)({},e||{}),{resources:new r.n(n)}))||this}return Object(a.__extends)(i,t),i}(this._viewModelType),o=function(){return t._getTemplateNodes()},s=this._automationName;return{instance:new(function(){function e(){}return e.prototype.toSpecification=function(e){return{automationName:s,viewModelType:i,getTemplateNodes:o,params:e}},e}())}},e.prototype._getTemplateNodes=function(){var e=u.utils.parseHtmlFragment(this._template);return this._getTemplateNodes=function(){return e},e},e}();function m(e){return new r.t({name:e.name,factory:new p({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})}var _=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.controlsDescendantBindings=!0;var i=a.element;return a._transcludedTemplateNodes=Array.prototype.slice.call(u.virtualElements.childNodes(i)),u.virtualElements.emptyNode(i),a._resolvedSpecification=a._getResolvedSpecification(),a._initializeRenderComponent(),a}return Object(a.__extends)(t,e),t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=h;var r=new o.e;return n.compute(function(){var o,c,d,u=e.valueAccessor();b(u)?(o=n.unwrap(u.specification),c=u.placeholder,d=u.error):o=n.unwrap(u),e.observables.ignore(function(){var n;if(o)if(g(o)){var u=o.params,f=o.definitionKey.local,p=t.consume(f.optional);if(p)i(p.toSpecification(u));else{if(c)if(g(c)){var m=t.consume(c.definitionKey.optional.local);m&&i(Object(a.__assign)(Object(a.__assign)({},m.toSpecification(c.params)),{isPlaceholder:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},c),{isPlaceholder:!0}));n=s.n.resolve(t.consumeAsync(f)).then(function(e){return e.toSpecification(u)})}}else i(o);else i(void 0);r.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!s.n.isCanceled(e)&&(l.e.log(e),d))if(g(d)){var n=t.consume(d.definitionKey.optional.local);n&&i(Object(a.__assign)(Object(a.__assign)({},n.toSpecification(Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}))),{isError:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},d),{params:Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}),isError:!0}))})):s.n.wrap())})}),i},t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,a=this.observables,i=this._transcludedTemplateNodes;a.compute(function(){var a=t._resolvedSpecification();t.observables.ignore(function(){if(e&&(e.dispose(),u.virtualElements.emptyNode(n)),a){var r=a.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new d.e)).attach(new a.viewModelType(a.params));e.attach(new c.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:a.automationName}));for(var s=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o,e.$componentTemplateNodes=i}),l=document.createDocumentFragment(),f=0,p=r;f<p.length;f++){var m=p[f];l.appendChild(m)}u.virtualElements.setDomNodeChildren(n,[l]),u.applyBindingsToDescendants(s,n);var _=t.valueAccessor();if(b(_)){var h=_.afterRender;!h||a.isPlaceholder||a.isError||h()}}})})},t.supportsVirtualElements=!0,t}(i.t);function h(e,t){return!e&&!t||e===t||!(!e||!t)&&e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params}function b(e){return!!e&&"object"==typeof e&&"specification"in e}function g(e){return!!e.definitionKey}t.n=_},2232:function(e,t,n){"use strict";var a=n(260),i=function(){function e(){}return e.prototype.debounce=function(e){var t=this;this.clear(),this._originalPromise=e;var n=new a.e(function(){return t._originalPromise.cancel()});return this._originalPromise.done(function(e){t._clear(!1),n.complete(e)},function(e){t._clear(!1),n.error(e)}),n.getPromise()},e.prototype.clear=function(){this._clear(!0)},e.prototype.isExecuting=function(){return Boolean(this._originalPromise)},e.prototype._clear=function(e){this.isExecuting()&&(e&&this._originalPromise.cancel(),this._originalPromise=null)},e}();t.e=i},2239:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return h}),n.d(t,"i",function(){return _}),n.d(t,"t",function(){return b});var a={};n.r(a),n.d(a,"fileNotFound",function(){return o}),n.d(a,"invalidView",function(){return s}),n.d(a,"listNotFound",function(){return c}),n.d(a,"docAlreadyExists",function(){return d}),n.d(a,"queryThrottled",function(){return l}),n.d(a,"newExperieceRenderingNotSupported",function(){return u}),n.d(a,"onePageNavigationViewMismatch",function(){return f}),n.d(a,"onePageNavigationError",function(){return p}),n.d(a,"offline",function(){return m});var i,r,o=-2147024894,s=-2147024809,c=-1,d=-2130575257,l=-2147024860,u=-2,f=-3,p=-4,m=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={}));var _,h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(_||(_={}));var b=a},2240:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(2219),r=n(108),o=n(260),s=n(1266),c=n(1196),d=n("react-lib"),l=n("react-dom-lib"),u=n(93),f=n("knockout-lib"),p=n(276),m=n(2232),_=n(85),h=n(219),b=n(102),g=n(800),v=n(330),y=n(2241),S=n(2272),D=new(function(){function e(){this._promises={}}return e.prototype.load=function(e){var t=e.path,n=e.getModule,a=window.require.toUrl("".concat(t,"_unmapped")),i=this._promises,c=i[a];c||(c=i[a]=r.n.as(Object(s.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[a]});var d=new o.e;return c.done(function(e){return d.complete(e)},function(e){return d.error(e)}),d.getPromise()},e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var a=t(e);if(a)if("object"==typeof a){if(Object.keys(a).length>0){var i=Object(c.e)(a);i&&(n=i)}}else n=a}return n},e}());function I(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,r=Object(a.__rest)(e,["applyBindings","bindingContext","children"]),o=d.useRef(null),s=Object(S.e)(),c=s[0],l=s[1],u=Object(y.e)({children:i}),p=d.useCallback(function(e){return d.createElement(d.Fragment,null,e.children)},[]),m=d.useRef(),_=d.useRef(!1);d.useEffect(function(){if(o.current&&t&&!_.current){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children"),o.current.appendChild(e)}var r=n||function(){var e=document.createElement("div");f.applyBindings({},e);var t=f.contextFor(e);return f.removeNode(e),t}(),s=t(o.current,r.extend(Object(a.__assign)({$react:c},i?{$data:{bindingHandlers:{react:x},Children:{componentType:p,props:u}}}:{})));m.current=function(){s&&s.dispose(),o.current&&f.cleanNode(o.current)}}},[]),d.useLayoutEffect(function(){return function(){_.current=!0;var e=m.current;e&&e()}},[]);var h=Object(v.e)(function(){return d.createElement("div",Object(a.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},r))},r);return d.createElement(d.Fragment,null,h,l)}var x=function(e){function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var a,i=n.observables;if(n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())}),n._value.peek().useDOMContext){var o=Object(g.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(a=f.contextFor(o))}else a=n.bindingContext;n._context=a&&a.$react,n._transcludedTemplateNodes=Array.prototype.slice.call(f.virtualElements.childNodes(n.element)),f.virtualElements.emptyNode(n.element),n._renderDependencies=n.createObservable(),n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)}),n._componentProps.equalityComparer=p.t,n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)}),n._rootProps.equalityComparer=p.t;var s=n.scope.attach(new m.e);return n.createComputed(function(){var e,t=n._value();if(function(e){return!!e.componentType}(t)){var a=n.observables.unwrap(t.componentType);n._componentNameForLogging=a.displayName||"",u.a.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=r.n.wrap(a)}else t.getModule||console.error("ReactBinding instantiated with componentPath ".concat(t.componentPath," but missing getModule")),n._componentNameForLogging=t.componentPath,u.a.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=D.load({path:t.componentPath,getModule:t.getModule});n.trackPromise(s.debounce(r.n.all({componentType:e}).then(function(e){u.a.mark("EUPL.ReactBinding.Loaded.".concat(n._componentNameForLogging));var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}}),n._renderDependencies(e)})))}),n.createComputed(n._computeRenderComponent),n}return Object(a.__extends)(t,e),t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),r=this._rootProps(),o=this._transcludedTemplateNodes;u.a.mark("EUPL.ReactBinding.AsyncRender.".concat(this._componentNameForLogging));try{this.observables.ignore(function(){var t=o.length>0?function(e,t){f.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,s=d.createElement(_.e,{resources:e.resources},d.createElement(h.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},d.createElement(n,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)({},i),t?{children:d.createElement(I,Object(a.__assign)({bindingContext:e.bindingContext,applyBindings:t},r||{}))}:{})))));e._context?e._context.render(s,e.element):l.render(s,e.element)})}catch(e){b.e.logError(e)}}},t}(i.t);t.t=x},2241:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"n",function(){return u}),n(0);var a=n("react-lib"),i=n(85),r=n(1323),o=n(2218),s=n(184),c=n(289);function d(e){var t=u(),n=t.peekUnwrap(e),i=a.useState(function(){return n})[1];return a.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]),n}function l(e,t){var n,i=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,r=u(),o=a.useRef(),d=o.current||(o.current=Object(s.e)(r.create(e),{equalityComparer:c.e}));return(i?a.useMemo:a.useEffect)(function(){d(e)},[e]),d}function u(){var e=Object(i.n)(),t=a.useRef(),n=t.current||(t.current=new(e.consume(o.i.optional)||r.e));return a.useLayoutEffect(function(){return function(){n.dispose()}},[]),n}},2250:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2252),i=n(62),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.t},e}(),o=Object(i.r)("ItemParentHelper",r)},2252:function(e,t,n){"use strict";n.d(t,"t",function(){return I});var a=n(0),i=n(2276),r=n(124),o=n(1323),s=n(6),c=n(62),d=n(594),l=n(1324),u=n(678),f=n(2485),p=n(1325),m=n(30),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)});t.e=D},2263:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var r=n(6),o=n(657),s=n(2284);function c(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var d={loadViewModel:function(e,t,n){n(function(n,d){void 0===n&&(n={});var l,u=i.contextFor(d.element),f=i.utils.unwrapObservable(n.resources)||c(u),p={owner:e,useFactoriesOnKeys:!0},m=f?new r.n(f,p):new r.n(p);n=Object(a.__assign)(Object(a.__assign)({},n),{resources:m}),l=function(e){return"function"==typeof e.createViewModel}(t)?t.createViewModel(n,d):new(m.injected(t))(n);var _=new s.e({name:e,viewModel:l,element:d.element,bindingContext:u});return Object(o.e)(l,function(){_.dispose(),m.dispose()})})}};i.components.loaders.unshift(d)},2268:function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){this._originalProvider=new a.bindingProvider,this._bindingHandlers={},this._bindingContexts=[]}return e.getInstance=function(){return e._instance},e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)},e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||a.bindingHandlers[e]},e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,r=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;return this._bindingHandlers[r]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)},this._bindingHandlers[r].after=t.after,t.supportsVirtualElements&&(a.virtualElements.allowedBindings[r]=!0),r},e.prototype._remapKeys=function(e,t){var n=e,a=this._getLocalBindingHandlers(t);if(a)for(var i in n={},e){var r=a[i];n[r&&this.getUniqueKeyForBindingHandler(r,i)||i]=e[i]}return n},e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t},e._instance=new e,e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey",e._lastUniqueKeyOrdinal=0,e}().getInstance();a.getBindingHandler=i.getBindingHandler.bind(i),a.bindingProvider.instance=i},2271:function(e,t,n){"use strict";var a=n("knockout-lib");n(2263),n(2268),window.__ko=a},2272:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n("react-lib"),r=n("react-dom-lib"),o=n(127),s=n(78),c=0,d=Object(o.e)(function(e){return"".concat(++c)});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(s.e)(function(e,t){n(function(n){var i,o=d(t);return Object(a.__assign)(Object(a.__assign)({},n),((i={})[o]=r.createPortal(e,t),i))})}),c=Object(s.e)(function(e){n(function(t){var n=t,i=d(e);return n[i],Object(a.__rest)(n,["symbol"==typeof i?i:i+""])})}),l=i.useRef(),u=l.current||(l.current={render:o,unmount:c}),f=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[u,f]},[u,f])}},2274:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},2276:function(e,t,n){"use strict";var a=n(38);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},2284:function(e,t,n){"use strict";var a="__ResourceComponentLoader$componentName",i="__ResourceComponentLoader$componentId",r="__ResourceComponentLoader$childComponents",o="__ResourceComponentLoader$parentComponentViewModel",s="__ResourceComponentLoader$componentBindingElement",c=0,d=function(){function e(e){var t=this._viewModel=e.viewModel,n=t[i]="".concat(++c);t[s]=e.element,t[r]={},t[a]=e.name;for(var d=e.bindingContext;d&&(!d.$data||d.$data===t||!d.$data[r]);)d=d.$parentContext;if(d){var l=this._parentViewModel=d.$data;l[r][n]=t,t[o]=l}}return e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e[i],c=t&&t[r];n&&c&&delete c[n],e&&(delete e[o],delete e[r],delete e[s],delete e[a])},e}();t.e=d},2322:function(e,t,n){"use strict";n.r(t),n.d(t,"OperationProvider",function(){return p}),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(2218),r=n(595),o=n(2341),s=n(1192),c=n(2483),d=function(e){function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=i.create(r.e.created),n.warning=i.create(""),n.error=i.create(),n.count=i.create(1);var c=Object(a.__assign)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:i.create(c.minimum),maximum:i.create(c.maximum),current:i.create(c.current)},n.type=i.create(t.type||s.e.multiple),n.batch=t.batch||new o.e,n._initializeActions(t.actions),n.payloads=i.create(t.payloads||{}),n.visibility=i.create(t.visibility||0),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new c.e({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(i.n),l=n(2672),u=n(2484),f=n(62),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new o.e;a._observers=i.createArray();var s=a.operations=i.createArray(),c=a.scope.attached(l.e),d=a.groups=a.addDisposable(u.e.group(s,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(l.e))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(a.__extends)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new d(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(a.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],o=i.state.peek();if(o===r.e.completed||!e&&(o===r.e.expired||o===r.e.canceled||o===r.e.failed))for(var s=i.operations.peek(),c=void 0,d=0;d<s.length;d++){c=!0;var l=s[d];if(o===r.e.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(s[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(i.n),m=Object(f.r)("OperationProvider",p);t.default=p},2341:function(e,t,n){"use strict";var a=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();t.e=a},2389:function(e,t,n){"use strict";var a=n(927);n.d(t,"t",function(){return a.n}),n.d(t,"e",function(){return a.t})},2390:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n("knockout-lib"),i="__automationBinding$elements";function r(e,t){var n=e[i];return n&&n[t]}t.e={init:function(e,t,n,r,o){if(a.applyBindingsToNode(e,{attr:{"data-automationId":t()}},o),o){var s=o.$component;if(s){var c=a.utils.unwrapObservable(t());if(c){var d=s[i];d||(d=s[i]={}),d[c]=e,a.utils.domNodeDisposal.addDisposeCallback(e,function(){d[c]&&delete d[c]})}}}}}},2410:function(e,t,n){"use strict";n.d(t,"t",function(){return m});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(98);Object(i.n)([{rawString:".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:first-child{animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:first-child{margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:first-child{margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"}]);var r=n(0),o=n(2220),s=n(116),c=n(2524),d=n(188),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(d.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=c.e,a}return Object(r.__extends)(t,e),t.resources=Object(r.__assign)(Object(r.__assign)({},o.e.dependencies),{platformDetection:d.e,settingsDataSource:s.ne}),t}(o.e),u=n(2221),f=n(2222),p=Object(u.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:l,synchronous:!0}),m=Object(f.t)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:l});t.e=p},2450:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(73).e);t.e=i},2483:function(e,t,n){"use strict";var a=n(0),i=n(2218),r=n(108),o=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,c=void 0===o?a.create(!0):o,d=t.onExecute,l=void 0===d?s:d;return n.count=r,n.isAvailable=c,n._onExecute=l.bind(t.operation),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=s},t.prototype.execute=function(){return this._onExecute()},t}(i.n);function s(){return r.n.wrap()}t.e=o},2484:function(e,t,n){"use strict";n(1916);var a=n(657),i=n("knockout-lib"),r=function(){function e(e,t){var n=this;this._source=e,this._getKey=t,this._groupsByKeyId={},this.groups=i.observableArray(),this._initializeGroups(),Object(a.e)(this.groups,function(){n._mapping.dispose()})}return e.group=function(t,n){return new e(t,n).groups},e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),a=JSON.stringify(n),r=e._groupsByKeyId[a];return r?r.values.push(t):(r={key:n,values:i.observableArray([t])},e._groupsByKeyId[a]=r,e.groups.push(r)),{mappedValue:a,dispose:function(){r.values.peek().length>1?r.values.remove(t):(delete e._groupsByKeyId[a],e.groups.remove(r))}}}})},e}();t.e=r},2485:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},2543:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(2218),i=n(6),r=n(1370),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},2581:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2218),i=new(n(6).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},2602:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("sharingContextInformation")},2619:function(e,t,n){"use strict";var a=n(2640),i=n("knockout-lib"),r=n(1324);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},2640:function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},2659:function(e,t,n){"use strict";n.d(t,"n",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"a",function(){return y});var a,i=n(0),r=n(374),o=n(170),s=n(443),c=n(118),d=n(62),l=n(46),u=n(2047),f=n(48),p=n(3540),m=n(260),_="OneUpViewer";function h(e){void 0===e&&(e="unknownViwer"),Object(c.r)("oneUp-".concat(e,".start"))}function b(e){return void 0===e&&(e="unknownViwer"),Object(c.i)("oneUp-".concat(e,".start"))}function g(e){return"number"==typeof e&&isNaN(e)?void 0:{data:e,needFlatten:!0}}!function(e){e[e.embed=0]="embed",e[e.oneup=1]="oneup"}(a||(a={}));var v=function(){function e(e,t){var n=this;this.resetRumOneApiMeasurement=function(){n._rumone.undoAPIInstrument()},this._computeRenderTime=function(e){if(e){var t=e.startTime,n=e.endTime;if(!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t)return n-t}return 0},this._checkRenderTimeRequiredDataAvailable=function(e){if(e){var t=e.startTime,n=e.endTime;return!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t}return!1};var a=t.pageContext;this._pageContext=a,this._initialized=!1;var i=Object(p.e)();this._rumone=r.e.getRUMOneLogger("oneup",function(e,t){u.e.withManager(i).logData({streamName:e,dictionary:t})})}return e.prototype.initRumoneLogger=function(){if(!this._initialized){this._initialized=!0;var e=this._pageContext&&this._pageContext.ariaCollectorUrl?new f.e(this._pageContext.ariaCollectorUrl).domain:"/Collector/3.0/";this._rumone.startAPIMeasurement({ignore:function(t){return t.indexOf(e)>=0},getAPIName:function(e){return e.toLowerCase().indexOf("/RenderListDataAsStream")?"RenderListDataAsStream":""}})}},e.prototype.logRumonePerformance=function(e,t){var n=this,r=e.viewerName,c=e.clientId,d=e.extension,l=e.fileSizeRange,u=e.embedStartLoadingTime,f=void 0===u?NaN:u,p=e.viewerStartTime,h=void 0===p?NaN:p,b=e.userClickTime,v=void 0===b?NaN:b,y=e.endTime,S=e.pageTransType,D=e.breakDownData,I=e.oneupScenario,x=e.isLightSpeed;f=this._regulateTime(f),v=this._regulateTime(v),y=this._regulateTime(y),h=this._regulateTime(h);var C=this._regulateTime(performance.timing.navigationStart),O=this._regulateTime(this._getResponseEnd()),w=this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")),E=v;isNaN(E)&&(E=f),isNaN(E)&&(E=C);var A=new m.e;if(this._rumone&&this._rumone.isRunning()){var L=x?I===a.embed?"ODSPEmbedLightSpeed.Load":"ODSPOneUpLightSpeed.Load":I===a.embed?"ODSPEmbed.Load":"ODSPOneUp.Load";this._rumone.writeScenarioId(L),this._rumone.addExpectedControl(_),this._rumone.writePageTransitionType(S||o.e.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var k=location.href.toLowerCase().indexOf("embed.aspx")>=0;k&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext),this._rumone.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(a,i,r){console.log("ttiAbsoluteTime",a);var o=n._regulateTime(a)-E;return n._rumone.addEUPLBreakdown("ttiAbsoluteTime_".concat(r),{data:a,needFlatten:!1}),n._rumone.addEUPLBreakdown("transactionStartTime_".concat(r),{data:E,needFlatten:!1}),r&&n._rumone.addEUPLBreakdown(r,{data:o,needFlatten:!1}),t&&t({EUPL:i.EUPL,TTI:o}),A.complete({FCI:o,FMP:i.EUPL,startTiming:n._regulateAbsoluteTime(E),AbsoluteFCI:n._regulateAbsoluteTime(a),AbsoluteFMP:e.endTime}),o},options:Object(i.__assign)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})},FCIMeasurementSettings:{disabled:!0}}});var M=new s.e({controlId:_,startTime:E,endTime:y,renderTimeCalculator:this._computeRenderTime,renderTimeRequiredDataChecker:this._checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(M),D=Object(i.__assign)(Object(i.__assign)({},D),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),herf:g(location.href),isEmbedASPXHosted:g(k),w3cResponseEnd:g(O-C),appStart:g(w-O),render:g(y-w),viewerRenderTime:g(y-h),oneUpViewer:g(r),oneUpClientId:g(c),oneUpFileExtension:g(d),oneUpFileSizeRange:g(l),beforeOneUpLoading:g(C-v),beforeOneUpLoadingIframeCost:g(C-f),beforeOneUpLoadingHostCost:g(f-v),userClickTime:g(v),embedStartLoadingTime:g(f),isLightSpeed:g(!!x)}),this._rumone.writeEUPLBreakdown(JSON.stringify(D)),console.log("RUMOne data: ",D)}return A.promise},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&c.e?e-performance.timing.navigationStart:e},e.prototype._regulateAbsoluteTime=function(e){return!this._isDateTime(e)&&c.e?e+performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e}(),y=Object(d.r)("OneUpRumoneHelper",v,{pageContext:l.e.optional})},2672:function(e,t,n){"use strict";var a=n(0),i=n(1192),r=n(595),o=n(2483),s=n(108),c=n(2218),d=n("knockout-lib");function l(e,t){var n,a=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){a(e.peek()-n)});return a(e.peek()),{dispose:function(){i.dispose(),r.dispose(),a(-e.peek())}}}var u=n(2484),f=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(a.__extends)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(u.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n,a,i,o,s,c,u=e.createPureComputed(function(){return r.e[t.state()]}),f=e.addDisposable(l(t.progress.minimum,e.progress.minimum)),p=e.addDisposable(l(t.progress.maximum,e.progress.maximum)),m=e.addDisposable(l(t.progress.current,e.progress.current)),_=e.addDisposable((n=u,a=e.states,o=function(e,t){var n=a.peek();void 0!==e&&n[e]--,void 0!==t&&(n[t]=(n[t]||0)+1),a.valueHasMutated()},s=n.subscribe(function(){i=n.peek()},null,"beforeChange"),c=n.subscribe(function(){o(i,n.peek())}),o(void 0,n.peek()),{dispose:function(){s.dispose(),c.dispose(),o(n.peek(),void 0)}})),h=e.addDisposable(function(e,t){var n=e.peek(),a=e.subscribe(function(){n=e.peek()},null,"beforeChange"),i=d.computed(function(){!t()&&e()&&t(e())}),r=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){i.dispose(),r.dispose(),a.dispose()}}}(t.error,e.error)),b=e.addDisposable(l(t.count,e.count)),g=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){u.dispose(),f.dispose(),p.dispose(),m.dispose(),_.dispose(),g.dispose(),h.dispose(),b.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?r.e.started:e.created?r.e.created:e.failed?r.e.failed:e.completed?r.e.completed:e.canceled?r.e.canceled:r.e.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return s.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||s.n.wrap()}))}}))},t}(c.n);t.e=f},2726:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=(n(2271),n("react-lib")),r=n(2222),o=n(6),s=n(2241),c=n(2240),d=n(78),l=n(85),u=n(441);function f(e){var t=e.specification,n=e.placeholder,a=Object(l.n)(),o=Object(s.e)(t),f=Object(d.e)(function(t,i){var s=new u.e;if(e.onApplyBindings){var c=e.onApplyBindings(t);c&&s.attach(c)}return s.attach(new(a.resolved(r.n))({element:t,valueAccessor:function(){return{specification:o,placeholder:n}},bindingContext:i})),s});return i.createElement(c.e,{applyBindings:f},e.children)}function p(e){var t=e.resources,n=Object(a.__rest)(e,["resources"]),r=i.createElement(f,Object(a.__assign)({},n));return t?i.createElement(l.e,{resources:t},r):r}t.t=p,new o.t({name:"Knockout",factory:new o.e(p)})},2802:function(e,t,n){"use strict";var a;!function(e){e[e.Lock=1]="Lock",e[e.Unlock=2]="Unlock",e[e.Manage=3]="Manage",e[e.FreDialog=4]="FreDialog",e[e.ShowFiles=5]="ShowFiles",e[e.Reset=6]="Reset",e[e.Debug=7]="Debug",e[e.FilesRemaining=8]="FilesRemaining"}(a||(a={})),t.e=a},3070:function(e,t,n){"use strict";var a=n(98);Object(a.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}])},3504:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return x});var a='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=(n(3070),n(0)),r=n(2220),o=n(2724),s=n(102),c=n(91),d=n(35),l=n(2543),u=n(89),f=n(62),p=n(116),m=function(){function e(e,t){this._errorDataSource=t.errorDataSource,this._defaultErrorAction={text:o.e,url:t.urlDataSource.getRootUrl()}}return e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction},e}(),_=Object(f.r)("ErrorProvider",m,{errorDataSource:p.f.optional,urlDataSource:p.he}),h=n(353),b=n(2802),g=n(30),v=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.error;a._navigation=a.resources.consume(u.e),a._actionMap=a.resources.consume(h.e.optional);var r,f,p,m,b,v,S=a.resources.consume(_);a.errorClassName="od-Error-imageTag",y(i)?(r=i.errorTitle,f=i.errorCode,p=i.errorDetailedText,m=i.errorDetailedHtml,b=i.correlationId,v=S.getAction(i)):i.message&&(p=i.message),r||(r=o.n),a.errorTitle=r,a.errorDetailedText=p,a.errorHtml=m,a.errorCode=f;var D=Object(g.isFeatureEnabled)(g.EmbedAccessOnEmbedAspx)&&Object(g.isFeatureEnabled)(g.EmbedLinkSupportOnEmbedAspx)&&"403"===f;return D||p||m||(p=o.t),D&&c.e.logData({name:"Error.RequesAccess.Loaded"}),a.errorDetailedText=p,a.showAction=!!v&&!v.hideButton&&!t.hideAction,v&&(a.actionText=v.text,a.actionUrl=v.url),a.showErrorCode=f&&a.errorTitle===o.n,a.showErrorCode?(s.e.log(i,"ServerError","".concat(f)),a.errorCodeText=d.format(o.v,f)):a.errorCodeText="",a.correlationIdText=b?d.format(o.y,b):"","accessremoved"===f?(a.isAccessRemoved=!0,a.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")):(a.isAccessRemoved=!1,a.imageUrl=a._getRandomImage()),y(i)&&i.actionUrl&&161===i.errorCode&&(a.resources.consume(l.resourceKey)(!1),a.actionText=o.m,a.errorDetailedText=o._,a.errorCodeText="",a.errorTitle=o.h,a.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg"),a.errorClassName="od-Error-vaultImage",c.e.logData({name:"Vault.Bookmarked.Loaded"})),a}return Object(i.__extends)(t,e),t.prototype.onButtonClick=function(){return this.showAction&&(161===this.errorCode&&this._actionMap?(c.e.logData({name:"Vault.Bookmarked.Unlock"}),new(this.managed(this._actionMap.VaultAction))({actionType:b.e.Unlock}).execute(null)):Object(g.isFeatureEnabled)(g.EmbedAccessOnEmbedAspx)&&Object(g.isFeatureEnabled)(g.EmbedLinkSupportOnEmbedAspx)&&self!==top&&this.actionUrl?(c.e.logData({name:"Error.RequesAccess.Click"}),this._popupCenter(this.actionUrl,"",860,500)):this._navigation.navigateTo(this.actionUrl)),!1},t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error".concat(e,".svg"))},t.prototype._popupCenter=function(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.outerWidth?window.outerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,s=(window.outerHeight?window.outerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-a/2+r,c=window.open(e,t,"scrollbars=yes, width="+n+", height="+a+", top="+s+", left="+o);return window.focus&&c&&c.focus(),c},t}(r.e);function y(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var S=n(2221),D=n(2222),I=S.e({tagName:"ms-error",template:a,viewModel:v,synchronous:!0}),x=Object(D.t)({name:"Error",automationName:"ms-error",template:a,viewModelType:v});t.default=I},3540:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(192);function i(){return window.ONEUPTELEMETRY_MANAGER=window.ONEUPTELEMETRY_MANAGER||Object(a.t)()}},3722:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(2218),r=n(108),o=n(62),s=n(1337),c=n(354),d=n(2389),l=n(21),u=n(353),f=n(2250),p=n(3723),m=n(2602),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._apiUrlHelper=n.apiUrlHelper,a._dataRequestor=a.scope.attach(new n.dataRequestorType({qosName:"PolicyTipDataSource"})),a._itemParentHelper=n.itemParentHelper,a._itemUrlHelper=n.itemUrlHelper,a._viewParams=n.viewParams,a._sharingContextInformation=n.sharingContextInformation,a}return Object(a.__extends)(t,e),t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?r.n.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})},t.prototype.getPolicyTip=function(e){if(this._isPseudo())return r.n.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:p.n.allowWithJustification,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return r.n.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return r.n.wrap(null);var n=t.MatchedConditionDescriptions,a=t.OverrideOptions,i=void 0===a?p.n.none:a,o=t.GeneralText,s=t.AppliedActionsText,c=Date.parse(t.LastProcessedTime);return{issueDescriptions:n&&n.results,overrideOption:Number(i),policyInfoUrl:t.ComplianceUrl,explanationText:o&&s?"".concat(o," ").concat(s):o||s||"",lastScanned:isNaN(c)?void 0:new Date(c)}})},t.prototype.updatePolicy=function(e){if(this._isPseudo())return r.n.wrap(e.action===p.e.override?p.t.overridden:e.action===p.e.reportFalsePositive?p.t.falsePositiveReportedAndOverridden:p.t.none);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,n=t&&t.OverridePolicyTip;return"number"==typeof n?n:null})},t.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)if(this._sharingContextInformation.uniqueId){var n=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",a={guid:this._sharingContextInformation.uniqueId};t=this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(n,a).segment("ListItemAllFields")}else t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var i=this._itemUrlHelper.getItemUrlParts(e.key),r=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(i).method("Lists",r).method("GetItemById",e.properties.ID)}return t},t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId},t.prototype._isPseudo=function(){return"1"===this._viewParams.peek()[l.n.pseudoPolicyTipKey]},t}(i.n),h=Object(o.r)("PolicyTipDataSource",_,{apiUrlHelper:s.e,dataRequestorType:d.t,itemParentHelper:f.e,itemUrlHelper:c.s,viewParams:u.P,sharingContextInformation:m.e.optional})},3723:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}},3729:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(6),i=n(62),r=new a.t({name:"OneUp.key",loader:new i.t(function(){return n.ee([629],4797).then(function(e){return e.resourceKey.local})})});t.e=r},3875:function(e,t,n){"use strict";var a=n(0),i=n(108),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odb/DeferredControls",getModule:function(){return i.n.resolve(n.ee([987],5884))},isLoaded:this.createObservable(!1)},e},t}(n(2218).n);t.e=r},4302:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)({name:"".concat("IsOneUpResourceKey",".isOneUp"),factory:{dependencies:{},create:function(e){return{instance:{isOneUp:!1}}}}})},5339:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return q});var a="\x3c!--ko control:controlBindingOptions--\x3e\x3c!--/ko--\x3e",i=n(0),r=n(62),o=n(3875),s=n(3722),c=n(21),d=n(116),l=n(2220),u=n(2222),f=n(3504),p=n(3729),m=n(2410),_=n(2724),h=n(97),b=n(1998),g=n(2619),v=n(2640),y=n(353),S=n(93),D=n(102),I=n(108),x=n(89),C=n(2),O=n(189),w=n(5),E=n(4302),A=n(420),L=n(46),k=n(2659),M=n(1253),P=n(1e3),T=n(834),U=n(3540),F=(n(1937),n(1220),n(1938),n(1935),n(1499)),H=n(426),R=n(148),N=n(157);n(192),F.e.init();var B=n(638),j=Object(U.e)();var V=n(170),z=!w.t.isActivated("33c8aed2-d511-433d-b84e-aa6b3d8f28b8","03/21/2023","new oneup perf telemetry"),G=function(e){function t(t,n){var a=this,l=Object(i.__assign)(Object(i.__assign)({},t),{queryParamKey:c.n.queryTypeParamKey}),u=(a=e.call(this,l,n)||this).resources;return u.expose(d.i,new(a.managed(o.e))),u.exposeFactory(d.W,new r.e(s.e)),a}return Object(i.__extends)(t,e),t}(function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:u.n});var r=a,o=r.observables,s=r.resources,c=s.consume(d.he),l=s.consume(b.resourceKey),w=s.consume(x.e).viewParams,k=s.consume(A.t.optional),U=s.consume(L.e.optional);U&&function(e){var t=e.initOneDS;if(e.spPageContext){var n={context:Object(i.__assign)(Object(i.__assign)({},Object(P.e)({viewParams:e.viewParams,clientName:e.clientName})),e.context||{}),pageContext:e.spPageContext,customManage:j,initOneDS:t};Object(M.e)(n)}else!function(e){var t="",n=window.PageContext,a=(null==n?void 0:n.env)||"devbox",r=window.Flight;if(r)if(r.ramps&&!r.Ramps&&(r.Ramps=r.ramps),r.usingRedirectCookie)t=e.tokens.ppe;else switch(a.toLowerCase()){case"edog":case"dogfood":case"prodbubble":t=e.tokens.ppe;break;case"prod":case"dprod":t=e.tokens.prod}else t=e.tokens.prod;var o=function(e){var t=window.PageContext,n=t.env||"devbox",a=window.Flight,i=e.oAuthToken&&function(e){if(e){var t=e.split(".");if(3===t.length)try{return JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}}(e.oAuthToken),r=i&&i.puid||a.session,o=i&&i.puid||t.userName,s=i&&i.tid||t.siteSubscriptionId;return{isAuthenticated:!!o,market:t.mkt,session:R.e.generate(),collectorUrl:t.ariaCollectorUrl,oneDsCollectorUrl:t.oneDsCollectorUrl,version:a.version,manifest:a.manifest||a.name,userId:r,accountType:o?N.e.Business:N.e.BusinessAnonymous,siteSubscriptionId:s,farmLabel:t.farmLabel,environment:n,workload:e.workload,disableCookies:!t.userName,context:e.context,cloudType:t.cloudType}}(e);e.context&&(o.context=Object(i.__assign)(Object(i.__assign)({},o.context),e.context)),t&&(e.initOneDS?new T.e({tenantToken:t,context:o}).attach(j):H.e.Init(t,o,void 0,void 0,j))}({viewParams:e.viewParams,clientName:e.clientName,tokens:B.e,oAuthToken:e.authToken,workload:"ODB",initOneDS:t,context:e.context})}({clientName:k||"unknown",viewParams:w,spPageContext:U});var F=c.getCurrentItemKey(w),V=c.getFocusItemKey(w);if(!V)return a.controlBindingOptions={specification:Object(u.a)(f.resourceKey,{error:new Error(_.l)})},a;var G=function(e,n){var a=c.getKeyParams(e);return n&&delete a[t.queryParamKey],{parentKey:e,ownerId:c.getOwnerId(e),queryType:c.getQueryType(a),ignoreChildren:n}},K=G(V,!0),W=l.getItemSync(K).item,q=l.getItemSync(G(F,!1)),Q=new g.e;Q.item=q.item,o.compute(function(){var e=new v.e;e.items=[W],Q.content(e)}),Object(C.qo)(C.Ao)||(S.a.mark("DataManager.GetData.Started"),a.trackPromise(l.getItem(K).then(function(){S.a.mark("DataManager.GetData.Done")},function(e){e.errorTitle||I.n.isCanceled(e)||D.e.log(e)}))),s.expose(y.r,q.item),s.expose(y.o,o.create(q)),s.expose(y._,o.create(Q)),s.expose(y.m,o.create(W));var Y=s.consume(E.e);Y.isOneUp=!!o.unwrap(W()),o.pureCompute(function(){var e=!!o.unwrap(W());return Y.isOneUp=e,e});var J=s.consume(O.e);return a.controlBindingOptions={specification:Object(u.a)(p.e.bypass,{onSlideLoaded:function(e){z&&a._logOneUpLoadingPerf(s,e),J.pageLoaded(h.e[h.e.OneUp])},openTime:0}),placeholder:Object(u.a)(m.t,{})},a}return Object(i.__extends)(t,e),t.prototype._logOneUpLoadingPerf=function(e,t){var n=t||{},a=n.viewer,i=n.extension,r=n.fileSizeRange;this._perfTelemetryReported||(this._perfTelemetryReported=!0,e.consume(k.a).logRumonePerformance({oneupScenario:1,viewerName:a,clientId:e.consume(A.t.optional),extension:i,fileSizeRange:r,endTime:Date.now(),pageTransType:V.e.fullPageLoad,viewerStartTime:Object(k.t)(a),userClickTime:void 0,embedStartLoadingTime:void 0,breakDownData:null==t?void 0:t.euplBreakDownData}))},t}(l.e)),K=n(2221),W=Object(K.e)({tagName:"od-spo-oneup",template:a,viewModel:G,synchronous:!0}),q=Object(u.t)({automationName:"",name:"OneUp",template:a,viewModelType:G});t.default=W},5873:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n("react-lib"),i=n(6),r=n(62),o=new i.t({name:"LegacyKnockoutEngagementHandlers.key",loader:new r.t(function(){return n.ee([1152],7543).then(function(e){return e.resourceKey})})}),s=n(116),c=n(592),d=n(85),l=Object(d.a)(function(e){e.exposeFactory(s.u,new r.e(o)),e.block(c.e)},{owner:"WithKnockoutEngagement"})(a.Fragment)},7069:function(e,t,n){"use strict";n.r(t),n.d(t,"KnockoutOneUp",function(){return m});var a=n("react-lib"),i=n(44),r=n(2726),o=n(2222),s=n(5339),c=n(686),d=n(498),l=n(8),u=n(2),f=n(5873);function p(e){var t=a.useState(function(){return Object(o.a)(s.resourceKey.bypass,{})})[0];return a.createElement(a.Fragment,null,a.createElement(c.e,{bypass:!0},a.createElement(f.e,null,a.createElement(r.e,{specification:t}))))}var m=Object(i.n)(function(e,t){var n;if(Object(u.qo)(u.Ao)){var i=null===(n=Object(d.e)(e))||void 0===n?void 0:n.focusItemKey;if(e.demandItemFacet(l.f,i),!e.isItemFacetResolved(l.f,i))return null}return a.createElement(p,null)})}}]);